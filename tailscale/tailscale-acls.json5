{
    // Declare static groups of users. Use autogroups for all users or users with a specific role.
    // "groups": {
    //   "group:example": ["alice@example.com", "bob@example.com"],
    // },

    // Define grants that govern access for users, groups, autogroups, tags,
    // Tailscale IP addresses, and subnet ranges.
    "grants": [
        // Allow all connections.
        // Comment this section out if you want to define specific restrictions.
        // { "src": ["*"], "dst": ["*"], "ip": ["*"] },

        // Trusted clients can access everything (TODO: No, this is bad!)
        {
            "src": ["tag:client"],
            "dst": ["*"],
            "ip": ["*"],
        },

        // Everything can make DNS requests
        {
            "src": ["*"],
            "dst": ["tag:dns"],
            "ip": ["udp:53", "tcp:53"],
        },

        // Allow users in "group:example" to access "tag:example", but only from
        // devices that are running macOS and have enabled Tailscale client auto-updating.
        // {"src": ["group:example"], "dst": ["tag:example"], "ip": ["*"], "srcPosture":["posture:autoUpdateMac"]},
    ],

    // Define postures that will be applied to all rules without any specific
    // srcPosture definition.
    // "defaultSrcPosture": [
    //      "posture:anyMac",
    // ],

    // Define device posture rules requiring devices to meet
    // certain criteria to access parts of your system.
    "postures": {
        "posture:nonMobile": ["node:os IN ['linux', 'macos', 'windows']"],
        "posture:mobile": ["node:os IN ['ios', 'android']"],
        "posture:upToDate": [
            "node:tsReleaseTrack == 'stable'",
            "node:tsAutoUpdate == true",
        ],

        // // Require devices running macOS, a stable Tailscale
        // // version and auto update enabled for Tailscale.
        // "posture:autoUpdateMac": [
        //     "node:os == 'macos'",
        //     "node:tsReleaseTrack == 'stable'",
        //     "node:tsAutoUpdate",
        // ],
        // // Require devices running macOS and a stable
        // // Tailscale version.
        // "posture:anyMac": [
        //     "node:os == 'macos'",
        //     "node:tsReleaseTrack == 'stable'",
        // ],
    },

    // Define users and devices that can use Tailscale SSH.
    "ssh": [
        // Allow all users to SSH into their own devices in check mode.
        // Comment this section out if you want to define specific restrictions.
        {
            "action": "check",
            "src": ["autogroup:member"],
            "dst": ["autogroup:self"],
            "users": ["autogroup:nonroot", "root"],
        },
    ],

    // Define the tags which can be applied to devices and by which users.
    "tagOwners": {
        // For human-operated machines I own and trust
        "tag:client": ["hello@zanbaldwin.com"],
        // For human-operated machines I do NOT own and trust
        "tag:guest": ["hello@zanbaldwin.com"],
        // For always-on LAN infrastructure
        "tag:lan": ["hello@zanbaldwin.com"],
        // When Tailscale is running from inside a container (including sandboxed apps, eg iPhone)
        "tag:container": ["hello@zanbaldwin.com"],
        // When Tailscale is running on bare-metal
        "tag:metal": ["hello@zanbaldwin.com"],
        // For NAS-specific ACLs
        "tag:nas": ["hello@zanbaldwin.com"],
        // For Pi-hole / DNS resolvers
        "tag:dns": ["hello@zanbaldwin.com"],
    },

    // Test access rules every time they're saved.
    // "tests": [
    //   {
    //       "src": "alice@example.com",
    //       "accept": ["tag:example"],
    //       "deny": ["100.101.102.103:443"],
    //   },
    // ],
}
